<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meus Links Favoritos</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Outfit', sans-serif; background-color: #f8fafc; }
        .modal { opacity: 0; visibility: hidden; transition: all 0.3s; z-index: 50; }
        .modal.active { opacity: 1; visibility: visible; }
        .site-card { transition: all 0.3s ease; }
        .site-card:hover { transform: translateY(-4px); box-shadow: 0 10px 20px rgba(0,0,0,0.05); }
        .code-area { font-family: monospace; background: #1e293b; color: #38bdf8; padding: 1rem; border-radius: 0.5rem; white-space: pre-wrap; word-break: break-all; }
    </style>
</head>
<body class="text-slate-800 min-h-screen flex flex-col">

    <!-- ========================================== -->
    <!--  BANCO DE DADOS LOCAL (SALVE AQUI)         -->
    <!-- ========================================== -->
    <script>
        // Quando você adicionar/remover sites, copie o código gerado e cole aqui:
        var database = [
 
        {
                    "id": 1766613482659,
                    "title": "Cartões Personalizados",
                    "url": "https://cinemaxbr18-crypto.github.io/Cartoes-Pesonalizados/",
                    "desc": "Um criador de cartões personalizados para você criar mensagem e vc enviar para quem você gosta",
                    "img": ""
          }
        ];
    </script>

    <!-- Navbar -->
    <nav class="bg-white border-b border-slate-200 sticky top-0 z-40 shadow-sm">
        <div class="max-w-6xl mx-auto px-4 h-16 flex justify-between items-center">
            <div class="flex items-center gap-2 font-bold text-xl">
                <div class="bg-blue-600 text-white w-8 h-8 rounded-lg flex items-center justify-center">
                    <i class="fa-solid fa-link"></i>
                </div>
                <span>Meus<span class="text-blue-600">Links</span></span>
            </div>

            <div class="flex gap-2">
                <!-- Botão Admin -->
                <button id="loginBtn" onclick="openModal('loginModal')" class="text-slate-500 hover:text-blue-600 px-3 py-2 text-sm font-medium">
                    <i class="fa-solid fa-lock"></i> Admin
                </button>
                
                <!-- Botões que só aparecem logado -->
                <button id="addBtn" onclick="openUpsertModal()" class="hidden bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-bold flex items-center gap-2 shadow-lg shadow-blue-200">
                    <i class="fa-solid fa-plus"></i> Novo Site
                </button>
                
                <button id="saveBtn" onclick="openExportModal()" class="hidden bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm font-bold flex items-center gap-2 animate-pulse">
                    <i class="fa-solid fa-cloud-arrow-up"></i> Salvar no GitHub
                </button>

                <button id="logoutBtn" onclick="logout()" class="hidden text-red-500 hover:bg-red-50 px-3 py-2 rounded-lg text-sm font-medium">
                    <i class="fa-solid fa-power-off"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- Área Principal -->
    <main class="flex-grow max-w-6xl mx-auto px-4 py-10 w-full">
        <div class="mb-8">
            <input type="text" id="search" placeholder="Pesquisar em seus links..." class="w-full max-w-md px-5 py-3 rounded-2xl border border-slate-200 focus:ring-4 focus:ring-blue-100 outline-none transition-all">
        </div>

        <div id="grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Cards via JS -->
        </div>

        <div id="empty" class="hidden text-center py-20 text-slate-400">
            <i class="fa-regular fa-face-frown text-5xl mb-4"></i>
            <p>Nenhum site encontrado.</p>
        </div>
    </main>

    <!-- MODAL: LOGIN -->
    <div id="loginModal" class="modal fixed inset-0 flex items-center justify-center bg-slate-900/50 backdrop-blur-sm">
        <div class="bg-white p-8 rounded-2xl shadow-xl w-full max-w-sm text-center">
            <h3 class="text-xl font-bold mb-4">Acesso Administrativo</h3>
            <input type="password" id="passInput" placeholder="Digite a senha" class="w-full px-4 py-3 border rounded-xl mb-4 text-center focus:ring-2 focus:ring-blue-500 outline-none">
            <div id="loginError" class="hidden text-red-500 text-sm mb-4">Senha incorreta!</div>
            <button onclick="checkLogin()" class="w-full bg-slate-900 text-white py-3 rounded-xl font-bold hover:bg-black transition-colors">Entrar</button>
            <button onclick="closeModal('loginModal')" class="mt-4 text-slate-400 text-sm">Cancelar</button>
        </div>
    </div>

    <!-- MODAL: ADICIONAR / EDITAR -->
    <div id="upsertModal" class="modal fixed inset-0 flex items-center justify-center bg-slate-900/50 backdrop-blur-sm">
        <div class="bg-white p-8 rounded-2xl shadow-xl w-full max-w-md">
            <h3 id="modalTitle" class="text-xl font-bold mb-6 text-slate-800">Novo Site</h3>
            <input type="hidden" id="editId">
            <div class="space-y-4">
                <input type="text" id="siteTitle" placeholder="Título do Site" class="w-full px-4 py-3 border rounded-xl outline-none focus:border-blue-500">
                <input type="url" id="siteUrl" placeholder="URL (Link)" class="w-full px-4 py-3 border rounded-xl outline-none focus:border-blue-500">
                <textarea id="siteDesc" placeholder="Descrição curta" class="w-full px-4 py-3 border rounded-xl outline-none focus:border-blue-500 h-24 resize-none"></textarea>
                <button onclick="handleSave()" class="w-full bg-blue-600 text-white py-4 rounded-xl font-bold hover:bg-blue-700 transition-colors">Salvar Dados</button>
                <button onclick="closeModal('upsertModal')" class="w-full text-slate-400 font-medium">Voltar</button>
            </div>
        </div>
    </div>

    <!-- MODAL: EXPORTAR CÓDIGO (Para o GitHub) -->
    <div id="exportModal" class="modal fixed inset-0 flex items-center justify-center bg-slate-900/50 backdrop-blur-sm p-4">
        <div class="bg-white p-6 rounded-2xl shadow-xl w-full max-w-2xl overflow-hidden flex flex-col max-h-[90vh]">
            <h3 class="text-lg font-bold text-green-700 mb-2 italic">Alterações detectadas!</h3>
            <p class="text-sm text-slate-500 mb-4">Para salvar permanentemente no GitHub, copie o código abaixo e substitua a linha 18 do seu arquivo <code>index.html</code>.</p>
            
            <div class="relative flex-grow overflow-auto custom-scrollbar">
                <div id="generatedCode" class="code-area text-xs"></div>
            </div>

            <div class="mt-6 flex gap-3">
                <button onclick="copyToClipboard()" class="flex-1 bg-green-600 text-white py-3 rounded-xl font-bold">Copiar Código</button>
                <button onclick="closeModal('exportModal')" class="px-6 py-3 bg-slate-100 text-slate-600 rounded-xl font-bold">Fechar</button>
            </div>
        </div>
    </div>

    <script>
        let isAdmin = false;
        let sites = [...database];
        let hasChanges = false;

        // Renderizar Lista
        function render() {
            const grid = document.getElementById('grid');
            const term = document.getElementById('search').value.toLowerCase();
            grid.innerHTML = '';

            const filtered = sites.filter(s => s.title.toLowerCase().includes(term) || s.desc.toLowerCase().includes(term));

            if(filtered.length === 0) {
                document.getElementById('empty').classList.remove('hidden');
            } else {
                document.getElementById('empty').classList.add('hidden');
                filtered.forEach(site => {
                    const domain = new URL(site.url).hostname;
                    const icon = `https://www.google.com/s2/favicons?domain=${domain}&sz=128`;
                    
                    grid.innerHTML += `
                        <div class="site-card bg-white p-5 rounded-2xl border border-slate-100 flex flex-col">
                            <div class="flex items-center gap-4 mb-4">
                                <img src="${icon}" class="w-12 h-12 rounded-xl bg-slate-50 p-2 border" onerror="this.src='https://ui-avatars.com/api/?name=${site.title}'">
                                <div class="flex-1">
                                    <h4 class="font-bold text-slate-800">${site.title}</h4>
                                    <p class="text-xs text-slate-400 truncate">${domain}</p>
                                </div>
                            </div>
                            <p class="text-slate-500 text-sm mb-6 flex-1 line-clamp-2">${site.desc}</p>
                            <div class="flex gap-2">
                                <a href="${site.url}" target="_blank" class="flex-1 bg-slate-50 text-slate-700 font-bold py-2 rounded-lg text-center text-sm hover:bg-blue-600 hover:text-white transition-all">Acessar</a>
                                ${isAdmin ? `
                                    <button onclick="prepareEdit(${site.id})" class="px-3 bg-amber-50 text-amber-600 rounded-lg hover:bg-amber-100"><i class="fa-solid fa-pen"></i></button>
                                    <button onclick="handleDelete(${site.id})" class="px-3 bg-red-50 text-red-600 rounded-lg hover:bg-red-100"><i class="fa-solid fa-trash"></i></button>
                                ` : ''}
                            </div>
                        </div>
                    `;
                });
            }
        }

        // Funções de Admin
        function checkLogin() {
            const pass = document.getElementById('passInput').value;
            if(pass === 'senha1809') {
                isAdmin = true;
                localStorage.setItem('adminLinks', 'true');
                closeModal('loginModal');
                updateUI();
                render();
            } else {
                document.getElementById('loginError').classList.remove('hidden');
            }
        }

        function logout() {
            isAdmin = false;
            localStorage.removeItem('adminLinks');
            updateUI();
            render();
        }

        function updateUI() {
            document.getElementById('loginBtn').classList.toggle('hidden', isAdmin);
            document.getElementById('addBtn').classList.toggle('hidden', !isAdmin);
            document.getElementById('logoutBtn').classList.toggle('hidden', !isAdmin);
            if(isAdmin && hasChanges) document.getElementById('saveBtn').classList.remove('hidden');
            else document.getElementById('saveBtn').classList.add('hidden');
        }

        // CRUD (Criar, Editar, Deletar)
        function handleSave() {
            const id = document.getElementById('editId').value;
            const title = document.getElementById('siteTitle').value;
            const url = document.getElementById('siteUrl').value;
            const desc = document.getElementById('siteDesc').value;

            if(!title || !url) return alert("Preencha os campos!");

            if(id) {
                const idx = sites.findIndex(s => s.id == id);
                sites[idx] = { ...sites[idx], title, url, desc };
            } else {
                sites.push({ id: Date.now(), title, url, desc, img: "" });
            }

            hasChanges = true;
            closeModal('upsertModal');
            updateUI();
            render();
        }

        window.handleDelete = function(id) {
            if(confirm("Deseja apagar este site?")) {
                sites = sites.filter(s => s.id !== id);
                hasChanges = true;
                updateUI();
                render();
            }
        }

        window.prepareEdit = function(id) {
            const s = sites.find(x => x.id == id);
            document.getElementById('editId').value = s.id;
            document.getElementById('siteTitle').value = s.title;
            document.getElementById('siteUrl').value = s.url;
            document.getElementById('siteDesc').value = s.desc;
            document.getElementById('modalTitle').textContent = "Editar Site";
            openModal('upsertModal');
        }

        // Exportação
        window.openExportModal = function() {
            const code = `var database = ${JSON.stringify(sites, null, 12)};`;
            document.getElementById('generatedCode').textContent = code;
            openModal('exportModal');
        }

        window.copyToClipboard = function() {
            const text = document.getElementById('generatedCode').textContent;
            navigator.clipboard.writeText(text).then(() => {
                alert("Código Copiado! Agora cole no seu arquivo index.html no GitHub.");
                hasChanges = false;
                updateUI();
                closeModal('exportModal');
            });
        }

        // Modais e UI
        window.openModal = (id) => document.getElementById(id).classList.add('active');
        window.closeModal = (id) => document.getElementById(id).classList.remove('active');
        window.openUpsertModal = () => {
            document.getElementById('editId').value = '';
            document.getElementById('siteTitle').value = '';
            document.getElementById('siteUrl').value = '';
            document.getElementById('siteDesc').value = '';
            document.getElementById('modalTitle').textContent = "Novo Site";
            openModal('upsertModal');
        }

        document.getElementById('search').addEventListener('input', render);
        
        // Auto-login se já logou antes na sessão
        if(localStorage.getItem('adminLinks')) {
            isAdmin = true;
            updateUI();
        }

        render();
    </script>
</body>
</html>

